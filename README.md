![image](https://github.com/nyano/Genshin_Material_Export/assets/5079651/c887e634-af43-4dbe-8f98-631976d382ef)# Genshin_Material_Export
原神素材数值导出工具【理论上支持星穹铁道。但是我删游戏了，所以自行测试】
  将素材的值利用图像识别的方式导出到excel的工具，用于素材缺口分析  
  本功能利用OCR来获得数值数，不修改游戏数据  

碎碎念：写的超慢，然后花了大量时间在物产志上浪费时间，写完了发现根本没用，然后直接转到背包项里  
  
问题1：速度：实测整个部分265个，滚动10次需要8分钟，40个需要1分钟，太慢了，尝试过多线程之后发现截图+OCR效率太慢，解决不下来（手动数据采集可能更快？但是我懒）  
问题2：非1080P界面可能运行有问题，因为还没测试  
问题3：还没做表格打开时再运行的
问题4：没有GUI界面，晚点再做
问题5：没做OCR模型学习，所以有些字导出来是错别字，需要手动修改

【dev4】背包数值采集  
该功能用于采集背包下里素材的数值，可以存放到excel表格中，用来分析还需要哪些材料，而不要一个一个导出了。实际使用的话分别为
【养成道具】角色经验素材、角色与武器培养素材、角色培养素材、角色突破素材、角色天赋素材、武器突破素材
【材料】素材、锻造用矿石、蒙德区域特产、……、食材、鱼饵、鱼
以上内容有采集意义，其他似乎意义不大。
步骤如下：  
1.下载库文件  
2.在python3.11环境下pip install -r rerquirements.txt，安装库  
将原神设为全屏或窗口化 1080P。如果不是1080P则可能无法运行  
3.打开原神，并且把界面放到【养成道具】或【材料】类目中，将第一排或需要的第一排能够完全显示图片内容（下次使用前记得把打开的test.xlsx关掉）  
4.运行python dev4-背包.py  
5.程序会自动单击、滚动并导出数值，运行时需要停止，请按F3  
如果不需要扫描整个类目，可以把需要的那一行手动放在第一行，之前的就不会扫描了  
6.程序完成后会显示结束，如果需要临时停止，请按F3，如果需要只扫到某个内容，则修改代码中cut_word=False改为True，并搜索cut_last_word = '子探测单元'值改为你需要指定的名称（如果OCR错误的字，则需要写错误的字）  
7.运行完成后，打开子目录dev4，其中的test.xlsx就是数据  

采集的位置如下：  
![image](https://github.com/nyano/Genshin_Material_Export/assets/5079651/4afe900f-a795-4cba-9cd0-6b8d46c23198)
导出的excel内容如下：  
![image](https://github.com/nyano/Genshin_Material_Export/assets/5079651/8c3ee216-b689-4983-b4e9-27391709933b)

修正后导出到excel内容类似如下：  
![image](https://github.com/nyano/Genshin_Material_Export/assets/5079651/96a6770c-4d6a-4772-b650-69a7ea6579e9)

与函数结合，可以使得数据自动化：  
角色素材部分：  
![1698819126727](https://github.com/nyano/Genshin_Material_Export/assets/5079651/6100d3ca-d08b-482b-9c56-ace451d782b6)

特产部分：  
![1698819177409](https://github.com/nyano/Genshin_Material_Export/assets/5079651/6b7fff62-34f6-4762-8799-e39f8c299741)

技能天赋部分：    
![1698819193181](https://github.com/nyano/Genshin_Material_Export/assets/5079651/0852683a-4222-42d3-8ed0-619951bc202f)

等等，需要多少，打什么怪就一目了然了  
excel并未上传，所以请自己整理  


以下文字可能被识别错误，需要手动替换（excel中可以用函数）：
黑晶号角	骗骗花蜜	名刀镡	影打刀镡	破旧的刀镡	夤夜刻像	孢囊晶尘	荧光孢粉	蕈兽孢子	锲纹的横脊	浊水的一掬	鎏金之鳞	祸神之禊泪	生长天地之蕨草	凛风奔狼的始龀	狮牙斗士的镣铐	谧林涓露的金符	谧林涓露的银符	谧林涓露的铁符	谧林涓露的铜符 晶化骨髓


【以下为老旧的部分，不用看了】
功能实现了。但是还没空写说明。。。有些东西好像还没上传。  
请等待
  
【功能1】dev.py -- 已完成  
  该脚本用于导出原神材料库中的比对图片，无需人工截图。会自动滚动，截取所有该列表的比对图片，尺寸保持一致。  
  比对坐标系定位：素材图片为123px的正方形。首个坐标系为118,121。横坐标向右间距为147px。向下坐标间距为175px
  图片的命名规则为：自增图片编号-行数-列数.png,如001-1-1.png
  
  有以下要求：  
  1.首先打开原神，1080P屏幕（其他尺寸没测试，应该不行，缩放到1080的DPI行不行？）  
  2.最好是大号，你的材料全，否则导出的数据肯定不全  
  3.如果材料有【新】字样，建议点以下去掉，以防止比对失败  
  4.材料界面的背景是磨砂，受到角色所在地的背景影响，建议不要花花绿绿的，影响比对
  注意：  
  1.每次运行前会清空dev文件夹，注意备份
  2.所有输出图片都在dev文件夹。首个输入文件为dev.png在根目录
  3.原神需要打开，且在存在dev.png图片的界面
  
【功能2】dev1.py --未完成  
  修改格式图片的文件名，添加英文说明【因为cv2不支持中文文件名。。。】
